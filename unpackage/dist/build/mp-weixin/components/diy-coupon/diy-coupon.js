(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/diy-coupon/diy-coupon"],{"14c4":function(t,o,e){"use strict";e.r(o);var n=e("c06c"),u=e.n(n);for(var i in n)"default"!==i&&function(t){e.d(o,t,(function(){return n[t]}))}(i);o["default"]=u.a},5383:function(t,o,e){},"9d8c":function(t,o,e){"use strict";e.r(o);var n=e("e74c"),u=e("14c4");for(var i in u)"default"!==i&&function(t){e.d(o,t,(function(){return u[t]}))}(i);e("9e57"),e("af45e");var c,s=e("f0c5"),a=Object(s["a"])(u["default"],n["b"],n["c"],!1,null,"4842399a",null,!1,n["a"],c);o["default"]=a.exports},"9e57":function(t,o,e){"use strict";var n=e("a308"),u=e.n(n);u.a},a308:function(t,o,e){},af45e:function(t,o,e){"use strict";var n=e("5383"),u=e.n(n);u.a},c06c:function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=u(e("faec"));function u(t){return t&&t.__esModule?t:{default:t}}var i={name:"diy-coupon",props:{value:{type:Object,default:function(){return{}}},siteId:{type:[Number,String],default:0}},mixins:[n.default],data:function(){return{token:"",couponList:[],isHave:!0,couponBtnSwitch:!1,couponTab:1}},created:function(){this.getCanReceiveCouponQuery()},computed:{computedCouponList:function(){var t=[];return this.couponList.filter((function(o){o.count!=o.lead_count&&t.push(o)})),t}},methods:{couponTap:function(t,o){t.count!=t.lead_count?0==t.useState?this.receiveCoupon(t,o):this.toGoodList(t):this.$util.showToast({title:"该优惠券已抢光"})},getCanReceiveCouponQuery:function(){var t,o=this;this.couponTab=this.siteId?0:1,t=0==this.couponTab?"/coupon/api/coupon/typepagelists":"/platformcoupon/api/platformcoupon/typepagelists";"diy"==this.value.sources&&(0,this.value.couponIds&&this.value.couponIds.split(",")),this.$api.sendRequest({url:t,data:{page:1,page_size:10,site_id:this.siteId,coupon_type_id_arr:this.value.couponIds},success:function(t){var e=t.data;null!=e&&(o.couponList=e.list,o.couponList.forEach((function(t){t.useState=0})))}})},receiveCoupon:function(o,e){var n=this;if(!this.couponBtnSwitch){this.couponBtnSwitch=!0;var u=t.getStorageSync("token");if(""!=u){var i,c={site_id:o.site_id,get_type:2};0==this.couponTab?(i="/coupon/api/coupon/receive",c.coupon_type_id=o.coupon_type_id):(i="/platformcoupon/api/platformcoupon/receive",c.platformcoupon_type_id=o.platformcoupon_type_id),this.$api.sendRequest({url:i,data:c,success:function(t){t.data;var e=t.message;0==t.code&&(e="领取成功");var u=n.couponList;if(0==n.couponTab)if(1==t.data.is_exist)for(var i=0;i<u.length;i++)u[i].coupon_type_id==o.coupon_type_id&&(u[i].useState=1);else for(var c=0;c<u.length;c++)u[c].coupon_type_id==o.coupon_type_id&&(u[c].useState=2);else if(1==t.data.is_exist)for(var s=0;s<u.length;s++)u[s].platformcoupon_type_id==o.platformcoupon_type_id&&(u[s].useState=1);else for(var a=0;a<u.length;a++)u[a].platformcoupon_type_id==o.platformcoupon_type_id&&(u[a].useState=2);n.$util.showToast({title:e}),n.couponBtnSwitch=!1,n.$forceUpdate()},fail:function(t){n.couponBtnSwitch=!1}})}else this.couponBtnSwitch=!1,this.$util.redirectTo("/pages/login/login/login")}},toGoodList:function(t){0==this.couponTab?1!=t.goods_type?this.$util.redirectTo("/otherpages/shop/list/list",{couponId:t.coupon_type_id,site_id:t.site_id}):this.$util.redirectTo("/otherpages/shop/list/list",{site_id:t.site_id}):1!=t.use_scenario?this.$util.redirectTo("/pages/goods/list/list",{platformcouponTypeId:t.platformcoupon_type_id}):this.$util.redirectTo("/pages/goods/list/list",{})}}};o.default=i}).call(this,e("543d")["default"])},e74c:function(t,o,e){"use strict";e.d(o,"b",(function(){return u})),e.d(o,"c",(function(){return i})),e.d(o,"a",(function(){return n}));var n={nsLogin:function(){return Promise.all([e.e("common/vendor"),e.e("components/ns-login/ns-login")]).then(e.bind(null,"ec11"))}},u=function(){var t=this,o=t.$createElement,e=(t._self._c,t.$util.img("/upload/uniapp/coupon/style1-bg.png")),n=t.computedCouponList.length>0&&"1"==t.value.style?t.__map(t.computedCouponList,(function(o,e){var n=t.__get_orig(o),u=o.discount&&"0.00"!=o.discount?null:Number(o.money),i=o.discount&&"0.00"!=o.discount?Number(o.discount):null,c=o.at_least>0?Number(o.at_least):null;return{$orig:n,m0:u,m1:i,m2:c}})):null,u=t.$util.img("/upload/uniapp/coupon/"+t.themeStyleScore+"_coupon.png"),i=t.computedCouponList.length>0&&"2"==t.value.style?t.__map(t.computedCouponList,(function(o,e){var n=t.__get_orig(o),u=o.discount&&"0.00"!=o.discount?null:Number(o.money),i=o.discount&&"0.00"!=o.discount?Number(o.discount):null,c=o.at_least>0?Number(o.at_least):null;return{$orig:n,m3:u,m4:i,m5:c}})):null,c=t.$util.img("/upload/uniapp/coupon/coupon_shu.png"),s=t.computedCouponList.length>0&&"3"==t.value.style?t.__map(t.computedCouponList,(function(o,e){var n=t.__get_orig(o),u=o.discount&&"0.00"!=o.discount?null:Number(o.money),i=o.discount&&"0.00"!=o.discount?Number(o.discount):null,c=o.at_least>0?Number(o.at_least):null;return{$orig:n,m6:u,m7:i,m8:c}})):null;t.$mp.data=Object.assign({},{$root:{g0:e,l0:n,g1:u,l1:i,g2:c,l2:s}})},i=[]}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/diy-coupon/diy-coupon-create-component',
    {
        'components/diy-coupon/diy-coupon-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("9d8c"))
        })
    },
    [['components/diy-coupon/diy-coupon-create-component']]
]);
