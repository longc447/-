(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/payment/payment"],{"64b17":function(t,e,n){"use strict";var a=n("a45a"),i=n.n(a);i.a},8554:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return a}));var a={uniPopup:function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"b9d3"))},nsSwitch:function(){return n.e("components/ns-switch/ns-switch").then(n.bind(null,"6908"))}},i=function(){var t=this,e=t.$createElement,n=(t._self._c,t._f("moneyFormat")(t.payMoney));t._isMounted||(t.e0=function(e,n){var a=arguments[arguments.length-1].currentTarget.dataset,i=a.eventParams||a["event-params"];n=i.index;t.payIndex=n}),t.$mp.data=Object.assign({},{$root:{f0:n}})},o=[]},"9dcd":function(t,e,n){"use strict";n.r(e);var a=n("f4e3"),i=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},a45a:function(t,e,n){},c351:function(t,e,n){"use strict";n.r(e);var a=n("8554"),i=n("9dcd");for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("64b17");var s,u=n("f0c5"),c=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],s);e["default"]=c.exports},f4e3:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=function(){n.e("components/uni-popup/uni-popup").then(function(){return resolve(n("b9d3"))}.bind(null,n)).catch(n.oe)},i=function(){n.e("components/ns-switch/ns-switch").then(function(){return resolve(n("6908"))}.bind(null,n)).catch(n.oe)},o={name:"payment",components:{uniPopup:a,nsSwitch:i},props:{balanceDeduct:{type:[Number,String],default:""},isBalance:{type:Number,default:0},payMoney:{type:[Number,String],default:0}},data:function(){return{isIphoneX:!1,payIndex:0,payTypeList:[{name:"微信支付",provider:"wxpay",icon:"iconweixin1",type:"wechatpay"}],payInfo:{}}},created:function(){this.isIphoneX=this.$util.uniappIsIPhoneX(),this.getPayType()},methods:{open:function(){this.$refs.choosePaymentPopup.open()},close:function(){this.$refs.choosePaymentPopup.close()},useBalance:function(){this.$emit("useBalance")},confirm:function(){0==this.payTypeList.length&&this.payMoney>0?this.$util.showToast({title:"请选择支付方式！"}):(t.showLoading({title:"支付中...",mask:!0}),this.$refs.choosePaymentPopup.close(),this.$emit("confirm"),t.setStorageSync("pay_flag",1))},getPayInfo:function(t){var e=this;this.$api.sendRequest({url:"/api/pay/info",data:{out_trade_no:t},success:function(t){t.code>=0&&t.data?(e.payInfo=t.data,e.pay()):(e.$util.showToast({title:"未获取到支付信息！"}),setTimeout((function(){e.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1e3))}})},getPayType:function(){var t=this;this.$api.sendRequest({url:"/api/pay/type",success:function(e){0==e.code&&t.payTypeList.forEach((function(n,a){-1==e.data.pay_type.indexOf(n.type)&&t.payTypeList.splice(a,1)}))}})},pay:function(){var e=this,n=this.payTypeList[this.payIndex];n&&"wxpay"==n.provider&&this.$api.sendRequest({url:"/api/pay/pay",data:{out_trade_no:this.payInfo.out_trade_no,pay_type:n.type},success:function(a){if(t.hideLoading(),a.code>=0){var i=a.data.data;t.requestPayment({provider:n.provider,timeStamp:i.timeStamp,nonceStr:i.nonceStr,package:i.package,signType:i.signType,paySign:i.paySign,success:function(t){e.$util.redirectTo("/pages/pay/result/result",{code:e.payInfo.out_trade_no},"","redirectTo")},fail:function(n){e.flag=!1,"requestPayment:fail cancel"==n.errMsg?e.$util.showToast({title:"您已取消支付"}):t.showModal({content:"支付失败,失败原因: "+n.errMsg,showCancel:!1}),setTimeout((function(){e.$util.redirectTo("/pages/pay/result/result",{code:e.payInfo.out_trade_no},"redirectTo")}),1e3)}})}else e.$util.showToast({title:a.message}),setTimeout((function(){e.$util.redirectTo("/pages/pay/result/result",{code:e.payInfo.out_trade_no},"redirectTo")}),1e3)},fail:function(n){t.hideLoading(),e.$util.showToast({title:"request:fail"})}})}},filters:{moneyFormat:function(t){return parseFloat(t).toFixed(2)}}};e.default=o}).call(this,n("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/payment/payment-create-component',
    {
        'components/payment/payment-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("c351"))
        })
    },
    [['components/payment/payment-create-component']]
]);
