(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/yzhua006-update/app-update"],{"326d":function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.downstatus<1||t.schedule?null:(t.downloadedSize/1024/1024).toFixed(2));t.$mp.data=Object.assign({},{$root:{g0:n}})},i=[]},"65d1":function(t,e,n){"use strict";var a=n("c498"),o=n.n(a);o.a},"843a":function(t,e,n){"use strict";n.r(e);var a=n("b0d6"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},ada9:function(t,e,n){"use strict";n.r(e);var a=n("326d"),o=n("843a");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("65d1");var u,d=n("f0c5"),l=Object(d["a"])(o["default"],a["b"],a["c"],!1,null,"9ca5d3ce",null,!1,a["a"],u);e["default"]=l.exports},b0d6:function(t,e,n){"use strict";(function(t){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={name:"appUpdate",props:{force:{type:Boolean,default:!0},tabbar:{type:Boolean,default:!1}},data:function(){return{popup_show:!1,platform:"",version:"1.0.0",need_update:!1,downing:!1,downstatus:0,update_info:{os:"",version:"",note:""},schedule:0,downloadedSize:0,viewObj:null}},created:function(){n=this},computed:{lengthWidth:function(){return{width:480*n.schedule/100+"rpx"}},getHeight:function(){var t=0;return n.tabbar&&(t=50),{bottom:t+"px"}}},methods:{update:function(){console.log("父组件触发方法")},getUpdateInfo:function(){t.request({url:"https://jhg.ruanjiangc.com/api/help/update",method:"get",success:function(t){console.log(t.data.data);for(var e=t.data.data,a=0;a<e.length;a++)if(n.platform==e[a]["os"]){n.update_info=e[a];break}n.update_info.os&&(console.log("后台返回的当前系统的升级参数",n.update_info),n.checkUpdate())}})},checkUpdate:function(){n.need_update=n.compareVersion(n.version,n.update_info.version),n.need_update&&(n.popup_show=!0,n.tabbar&&(n.viewObj=new plus.nativeObj.View("viewObj",{bottom:"0px",left:"0px",height:"50px",width:"100%",backgroundColor:"rgba(0,0,0,.6)"}),n.viewObj.show()))},closeUpdate:function(){n.force?"Android"==plus.os.name?plus.runtime.quit():plus.ios.import("UIApplication").sharedApplication().performSelector("exit"):(n.popup_show=!1,n.viewObj.hide())},nowUpdate:function(){if(n.downing)return!1;n.downing=!0,/\.apk$/.test(n.update_info.download_url)||/\.wgt$/.test(n.update_info.download_url)?n.download_wgt():plus.runtime.openURL(n.update_info.download_url,(function(){plus.nativeUI.toast("打开错误")}))},download_wgt:function(){plus.nativeUI.showWaiting("下载更新文件...");var t={method:"get"},e=plus.downloader.createDownload(n.update_info.download_url,t,(function(t,e){}));e.addEventListener("statechanged",(function(t,e){if(null===e);else if(200==e)switch(n.downstatus=t.state,t.state){case 3:n.downloadedSize=t.downloadedSize;var a=0;t.totalSize&&(a=t.totalSize),n.schedule=parseInt(100*t.downloadedSize/a);break;case 4:n.installWgt(t.filename);break}else plus.nativeUI.closeWaiting(),plus.nativeUI.toast("下载出错"),n.downing=!1,n.downstatus=0})),e.start()},installWgt:function(t){plus.nativeUI.showWaiting("安装更新文件..."),plus.runtime.install(t,{},(function(){plus.nativeUI.closeWaiting(),plus.nativeUI.alert("应用资源下载完成！",(function(){plus.runtime.restart()}))}),(function(t){plus.nativeUI.closeWaiting(),plus.nativeUI.alert("安装更新文件失败["+t.code+"]："+t.message)}))},compareVersion:function(t,e){if(!t||!e||""==t||""==e)return!1;for(var n=t.split(".",4),a=e.split(".",4),o=0;o<n.length&&o<a.length;o++){var i=n[o],u=parseInt(i),d=a[o],l=parseInt(d);if(l>u||d.length>i.length)return!0;if(l<u)return!1}return a.length>n.length&&0==e.indexOf(t)}}};e.default=a}).call(this,n("543d")["default"])},c498:function(t,e,n){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/yzhua006-update/app-update-create-component',
    {
        'components/yzhua006-update/app-update-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("ada9"))
        })
    },
    [['components/yzhua006-update/app-update-create-component']]
]);
