(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["otherpages/goods/coupon/coupon"],{1504:function(t,o,e){"use strict";e.r(o);var n=e("6ecb"),i=e.n(n);for(var s in n)"default"!==s&&function(t){e.d(o,t,(function(){return n[t]}))}(s);o["default"]=i.a},"60d5":function(t,o,e){},"6ecb":function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=s(e("f725")),i=s(e("faec"));function s(t){return t&&t.__esModule?t:{default:t}}var u={data:function(){return{couponTab:0,list:[],back:"/otherpages/goods/coupon/coupon"}},onShow:function(){var t=this;this.$langConfig.refresh(),this.addonIsExit.coupon||(this.$util.showToast({title:"优惠券未启用",mask:!0}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"redirectTo")}),1e3))},mixins:[i.default,n.default],computed:{addonIsExit:function(){return this.$store.state.addonIsExit}},methods:{liClick:function(t,o){0==t.useState?this.receiveCoupon(t,o):this.toGoodsList(t,o)},couponTabOn:function(t){this.couponTab=t,this.list=[],this.$refs.mescroll.refresh(!1)},receiveCoupon:function(o,e){var n=this;if(!this.couponBtnSwitch){this.couponBtnSwitch=!0;var i=t.getStorageSync("token");if(""!=i){var s,u={site_id:o.site_id,get_type:2};0==this.couponTab?(s="/coupon/api/coupon/receive",u.coupon_type_id=o.coupon_type_id):(s="/platformcoupon/api/platformcoupon/receive",u.platformcoupon_type_id=o.platformcoupon_type_id),this.$api.sendRequest({url:s,data:u,success:function(t){t.data;var e=t.message;0==t.code&&(e="领取成功");var i=n.list;if(0==n.couponTab)if(1==t.data.is_exist)for(var s=0;s<i.length;s++)i[s].coupon_type_id==o.coupon_type_id&&(i[s].useState=1);else for(var u=0;u<i.length;u++)i[u].coupon_type_id==o.coupon_type_id&&(i[u].useState=2);else if(1==t.data.is_exist)for(var a=0;a<i.length;a++)i[a].platformcoupon_type_id==o.platformcoupon_type_id&&(i[a].useState=1);else for(var c=0;c<i.length;c++)i[c].platformcoupon_type_id==o.platformcoupon_type_id&&(i[c].useState=2);n.$util.showToast({title:e}),n.couponBtnSwitch=!1},fail:function(t){n.couponBtnSwitch=!1}})}else this.bindgetuserinfo()}},bindgetuserinfo:function(){if(this.$util.isWeiXin()){var t="";t=this.back?n.default.h5Domain+"/pages/login/login/login?back="+encodeURIComponent(this.back):n.default.h5Domain+"/pages/login/login/login",this.$api.sendRequest({url:"/wechat/api/wechat/authcode",data:{redirect_url:t},success:function(t){t.code>=0&&(location.href=t.data)}})}else this.back?this.$util.redirectTo("/pages/login/login/login",{back:this.back}):this.$util.redirectTo("/pages/login/login/login");this.couponBtnSwitch=!1},getMemberCounponList:function(t){var o,e=this;o=0==this.couponTab?"/coupon/api/coupon/typepagelists":"/platformcoupon/api/platformcoupon/typepagelists",this.$api.sendRequest({url:o,data:{page:t.num,page_size:t.size},success:function(o){var n=[],i=o.message;0==o.code&&o.data?n=o.data.list:e.$util.showToast({title:i}),n.length&&n.forEach((function(t){t.useState=0})),t.endSuccess(n.length),n.length&&n.forEach((function(t){t.count==t.lead_count?t.useState=2:t.useState=0})),1==t.num&&(e.list=[]),e.list=e.list.concat(n),e.$refs.loadingCover&&e.$refs.loadingCover.hide()},fail:function(){t.endErr(),this.$refs.loadingCover&&this.$refs.loadingCover.hide()}})},toGoodsList:function(t){0==this.couponTab?1!=t.goods_type?this.$util.redirectTo("/otherpages/shop/list/list",{couponId:t.coupon_type_id,site_id:t.site_id}):this.$util.redirectTo("/otherpages/shop/list/list",{site_id:t.site_id}):1!=t.use_scenario?this.$util.redirectTo("/pages/goods/list/list",{platformcouponTypeId:t.platformcoupon_type_id}):this.$util.redirectTo("/pages/goods/list/list",{})}},onShareAppMessage:function(t){var o="送您一张优惠券,快来领取吧",e="/otherpages/goods/coupon/coupon";return{title:o,path:e,success:function(t){},fail:function(t){}}}};o.default=u}).call(this,e("543d")["default"])},"94d6":function(t,o,e){"use strict";e.r(o);var n=e("d7f0"),i=e("1504");for(var s in i)"default"!==s&&function(t){e.d(o,t,(function(){return i[t]}))}(s);e("c43c");var u,a=e("f0c5"),c=Object(a["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],u);o["default"]=c.exports},bf30:function(t,o,e){"use strict";(function(t){e("c5b8");n(e("66fd"));var o=n(e("94d6"));function n(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,e("543d")["createPage"])},c43c:function(t,o,e){"use strict";var n=e("60d5"),i=e.n(n);i.a},d7f0:function(t,o,e){"use strict";e.d(o,"b",(function(){return i})),e.d(o,"c",(function(){return s})),e.d(o,"a",(function(){return n}));var n={nsEmpty:function(){return e.e("components/ns-empty/ns-empty").then(e.bind(null,"467b"))},loadingCover:function(){return e.e("components/loading-cover/loading-cover").then(e.bind(null,"f410"))}},i=function(){var t=this,o=t.$createElement,e=(t._self._c,t.addonIsExit.coupon?t.__map(t.list,(function(o,e){var n=t.__get_orig(o),i=t.$util.img(2==o.useState?"/upload/uniapp/coupon/bg_lingqu_gary.png":"/upload/uniapp/coupon/bg_lingqu.png"),s=o.discount&&"0.00"!=o.discount?null:parseInt(o.money),u=o.discount&&"0.00"!=o.discount&&"discount"==o.type?parseFloat(o.discount):null,a=o.validity_type?null:t.$util.timeStampTurnTime(o.end_time);return{$orig:n,g0:i,m0:s,m1:u,g1:a}})):null);t.$mp.data=Object.assign({},{$root:{l0:e}})},s=[]}},[["bf30","common/runtime","common/vendor"]]]);