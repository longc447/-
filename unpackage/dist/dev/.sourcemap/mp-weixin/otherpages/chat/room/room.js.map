{"version":3,"sources":["uni-app:///main.js","webpack:////Users/longchu/Documents/镜惠购/otherpages/chat/room/room.vue?782e","webpack:////Users/longchu/Documents/镜惠购/otherpages/chat/room/room.vue?0ae1","webpack:////Users/longchu/Documents/镜惠购/otherpages/chat/room/room.vue?c943","webpack:////Users/longchu/Documents/镜惠购/otherpages/chat/room/room.vue?d28c","uni-app:///otherpages/chat/room/room.vue","webpack:////Users/longchu/Documents/镜惠购/otherpages/chat/room/room.vue?e6e2","webpack:////Users/longchu/Documents/镜惠购/otherpages/chat/room/room.vue?75f9"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,qG,6FAFmBA,EAAE,CAACC,iCAAH,GAAuCC,mBAAvC;AAGnBC,UAAU,CAACC,aAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiH;AACjH;AACwD;AACL;AACc;;;AAGjE;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,+EAAM;AACR,EAAE,wFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC3BA;AAAA;AAAA;AAAA;AAAk0B,CAAgB,kyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC8Ct1B;;AAEA;AACA,wG;AACA;AACA;AACA,4BADA,EADA;;AAIA,MAJA,kBAIA;AACA;AACA,yCADA;AAEA,sBAFA;AAGA,qBAHA;AAIA;AACA,mBADA;AAEA,mBAFA;AAGA,mBAHA;AAIA,iBAJA,EAJA;;AAUA,sBAVA;AAWA,iBAXA;;AAaA,qBAbA;AAcA,aAdA;AAeA,kBAfA;AAgBA,kBAhBA;AAiBA,wBAjBA,EAiBA;;AAEA,sBAnBA;AAoBA,kBApBA;AAqBA,uBArBA;;AAuBA,eAvBA,EAuBA;AACA,cAxBA,EAwBA;AACA,gBAzBA,EAyBA;AACA,kBA1BA,EA0BA;AACA,kBA3BA;AA4BA,kBA5BA;AA6BA,eA7BA,EA6BA;AACA,mBA9BA;AA+BA,sBA/BA;AAgCA,0BAhCA;AAiCA;AACA,0BADA;AAEA,wBAFA,EAjCA;;;AAsCA,GA3CA;AA4CA,sDA5CA;AA6CA;AACA,cADA,wBACA;AACA;AACA,KAHA,EA7CA;;AAkDA,QAlDA,kBAkDA,IAlDA,EAkDA;AACA;AACA;AACA;AACA,KAHA,MAGA;AACA;AACA,uBADA;;AAGA;AACA;AACA,OAFA,EAEA,IAFA;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAFA,MAEA;AACA;AACA;AACA;AACA;AACA,KAFA,MAEA;AACA;AACA;;AAEA;AACA;AACA,KAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GA1FA;AA2FA,SA3FA,qBA2FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KALA;AAMA,GAnGA;AAoGA;AACA;AACA,iBAFA,2BAEA;AACA;AACA,YADA,CACA,SADA;AAEA,aAFA,CAEA,iBAFA;AAGA,UAHA;AAIA,KAPA;AAQA;AACA,iBATA,2BASA;AACA;AACA,YADA,CACA,SADA;AAEA,aAFA,CAEA;AACA;AACA;AACA;AACA;AACA,WAHA;;AAKA,OATA;AAUA,UAVA;AAWA,KArBA;AAsBA;AACA,gBAvBA,0BAuBA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,OAFA;AAGA,KAnCA;AAoCA;AACA,eArCA,yBAqCA;AACA;AACA;AACA;AACA;AACA,8BADA;;AAGA,OANA,MAMA;AACA;AACA,+BADA;AAEA;AACA,gCADA,EAFA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA,sCADA;;AAGA;AACA,WAdA;;AAgBA;AACA,KA9DA;AA+DA;AACA,eAhEA,yBAgEA;AACA;AACA,+BADA;AAEA;AACA;AACA;AACA;AACA,SANA;;AAQA,KAzEA;AA0EA;AACA,eA3EA,yBA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCADA;AAEA;AACA,uCADA;AAEA,yBAFA;AAGA,kBAHA;AAIA,8BAJA,EAFA;;AAQA,eARA,mBAQA,GARA,EAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BADA;AAEA,4BAFA;AAGA,uCAHA;AAIA,kCAJA;;AAMA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAFA,MAEA;AACA;AACA;AACA,iBAZA,MAYA;AACA;AACA;AACA;AACA;AACA,mBAFA,MAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAFA,MAEA;AACA;AACA;;AAEA,iBAlBA,MAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAFA,MAEA;AACA;AACA;AACA,iBAZA,MAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAFA,MAEA;AACA;AACA;AACA;AACA,eAPA;AAQA;AACA,WA/GA,MA+GA;AACA;AACA,gCADA;;AAGA;AACA,SA/HA;;AAiIA,KAxNA;AAyNA;AACA,mBA1NA,2BA0NA,EA1NA,EA0NA;AACA;AACA;AACA,2BADA;AAEA,UAFA,CAEA,IAFA;AAGA,cAHA,CAGA,EAHA;AAIA;AACA;AACA,mCADA,EACA;AACA,uBAFA;;AAIA,SALA,EAKA,IALA;AAMA,OAXA,MAWA;AACA;AACA;AACA,cADA,CACA,mBADA;AAEA,0BAFA,CAEA;AACA;AACA,uCADA,EACA;AACA,uBAFA;;AAIA,SAPA;AAQA,YARA;AASA;AACA,KAlPA;AAmPA;AACA,YApPA,oBAoPA,CApPA,EAoPA,KApPA,EAoPA;AACA;AACA;AACA,KAvPA;AAwPA;AACA,aAzPA,qBAyPA,CAzPA,EAyPA,KAzPA,EAyPA;AACA;AACA;AACA,KA5PA;AA6PA;AACA,WA9PA,mBA8PA,IA9PA,EA8PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCADA;AAEA;AACA,gCADA;AAEA,yCAFA;AAGA,2BAHA;AAIA,gCAJA;AAKA,8CALA,EAFA;;AASA,iBATA,mBASA,GATA,EASA;AACA;AACA;AACA,WAZA;AAaA,kBAbA,sBAaA;AACA;AACA;AACA,WAhBA;;AAkBA,OAxBA,MAwBA;AACA;AACA,uCADA;AAEA;AACA,kCADA;AAEA,yCAFA;AAGA,gCAHA;AAIA,2BAJA,EAFA;;AAQA,iBARA,mBAQA,GARA,EAQA;AACA;AACA;AACA,WAXA;;AAaA,kBAbA,sBAaA;AACA;AACA;AACA,WAhBA;;AAkBA,OAnBA,MAmBA;AACA;AACA;AACA,uCADA;AAEA;AACA,+CADA;AAEA,yCAFA;AAGA,gCAHA;AAIA,2BAJA,EAFA;;AAQA,iBARA,mBAQA,GARA,EAQA;AACA;AACA,WAVA;AAWA,eAXA,mBAWA;AACA;AACA;AACA,kBADA,CACA,SADA;AAEA,mBAFA,CAEA;AACA;AACA;AACA,aALA;AAMA,gBANA;AAOA,WApBA;AAqBA,kBArBA,sBAqBA;AACA;AACA;AACA,WAxBA;;AA0BA,OA5BA,MA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BADA;;AAGA;AACA,gBADA,CACA,SADA;AAEA,iBAFA,CAEA;AACA;AACA;AACA,WALA;AAMA,cANA;AAOA;AACA;AACA;AACA;AACA;AACA,uCADA;AAEA;AACA,0CADA;AAEA,yCAFA;AAGA,gCAHA;AAIA,2BAJA,EAFA;;AAQA,iBARA,mBAQA,GARA,EAQA;AACA;AACA;AACA;AACA;AACA,kBADA,CACA,SADA;AAEA,mBAFA,CAEA;AACA;AACA;AACA,aALA;AAMA,gBANA;AAOA,WAnBA;AAoBA,eApBA,mBAoBA;AACA;AACA;AACA,kBADA,CACA,SADA;AAEA,mBAFA,CAEA;AACA;AACA;AACA,aALA;AAMA,gBANA;AAOA,WA7BA;AA8BA,kBA9BA,sBA8BA;AACA;AACA;AACA,WAjCA;;AAmCA;AACA,KAnYA;AAoYA;AACA,YArYA,oBAqYA,OArYA,EAqYA,WArYA,EAqYA;AACA;AACA,sBADA,GACA;AACA,gCADA;AAEA,4CAFA;AAGA,oCAHA,EADA;;AAMA;AACA;AACA,mBAFA,MAEA;AACA;AACA,mBAFA,MAEA;AACA;AACA,mBAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAFA;AAGA,iBArBA;AAsBA,KA3ZA;AA4ZA;AACA,gBA7ZA,wBA6ZA,IA7ZA,EA6ZA;AACA;AACA;AACA;AACA;AACA,SAFA,EAEA,GAFA;AAGA,OALA,MAKA;AACA;AACA;AACA;AACA,KAvaA;AAwaA,gBAxaA,wBAwaA,CAxaA,EAwaA;AACA;AACA;AACA;AACA,KA5aA;AA6aA;AACA,cA9aA,sBA8aA,CA9aA,EA8aA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAFA;AAGA,KAvbA;AAwbA,kBAxbA,4BAwbA;AACA;AACA;AACA;AACA;AACA,KA7bA;AA8bA;AACA,aA/bA,uBA+bA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAFA;AAGA,KA5cA;AA6cA;AACA,YA9cA,oBA8cA,KA9cA,EA8cA,KA9cA,EA8cA;AACA;AACA,YADA,CACA,SADA;AAEA,aAFA,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBADA;;AAGA;AACA;AACA,WAbA;;AAeA,OAnBA;AAoBA,UApBA;AAqBA;AACA,KAreA;AAseA;AACA,UAveA,oBAueA;AACA;AACA,OADA,EACA;AACA,uBADA,EADA;;AAIA;AACA;AACA;AACA;AACA,OARA;AASA,kCATA;;AAWA,KAnfA,EApGA;;AAylBA,eAzlBA,2BAylBA;AACA;AACA;AACA;AACA,mCADA;AAEA;AACA,qCADA;AAEA,4BAFA,EAFA;;AAMA,aANA,mBAMA,GANA,EAMA;AACA;AACA,OARA;;AAUA,GAtmBA,E;;;;;;;;;;;;;AClDA;AAAA;AAAA;AAAA;AAAiiD,CAAgB,i6CAAG,EAAC,C;;;;;;;;;;;ACArjD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"otherpages/chat/room/room.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './otherpages/chat/room/room.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./room.vue?vue&type=template&id=7ba9b596&\"\nvar renderjs\nimport script from \"./room.vue?vue&type=script&lang=js&\"\nexport * from \"./room.vue?vue&type=script&lang=js&\"\nimport style0 from \"./room.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"otherpages/chat/room/room.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=template&id=7ba9b596&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.emjoyShow\n    ? _vm.__map(_vm.emjoyList, function(item, index) {\n        var $orig = _vm.__get_orig(item)\n\n        var g0 = _vm.$util.img(item)\n        return {\n          $orig: $orig,\n          g0: g0\n        }\n      })\n    : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"container\" id=\"container\" :data-theme=\"themeStyle\">\r\n\t\t<view class=\"room\" @click=\"closePopWindow\">\r\n\t\t\t<view class=\"tips\" :class=\"{ show: isLoading }\">正在获取消息</view>\r\n\t\t\t<view class=\"room-content-box\">\r\n\t\t\t\t<view :id=\"'chat' + index\" v-for=\"(item, index) in messageList\" :key=\"index\">\r\n\t\t\t\t\t<chat-message :message=\"item\" :shopInfo=\"shopInfo\" :userInfo=\"userInfo\" @sendGood=\"sendGood($event, index)\"\r\n\t\t\t\t\t @sendOrder=\"sendOrder($event, index)\" :send=\"send\"></chat-message>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"paddingbottom\" id=\"paddingbottom\" v-if=\"chatBottom\"></view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"input-content\">\r\n\t\t\t<view class=\"input-box\">\r\n\t\t\t\t<view class=\"iconfont iconbiaoqing1 padding-right \" @click=\"openEmjoy()\"></view>\r\n\t\t\t\t<editor id=\"editor\" class=\"message-edit\" v-model=\"formData.content\" @ready=\"onEditorReady\" @focus=\"inputFocus\"\r\n\t\t\t\t @input=\"onEditorinput()\" @blur=\"closePopWindow()\"></editor>\r\n\t\t\t\t<!-- <input type=\"text\" class=\"message\" placeholder=\"点此提问客服\" id=\"input\" v-model=\"formData.content\" placeholder-style=\"color:#DDDDDD;\"\r\n\t\t\t\t cursor-spacing=\"10\" @confirm=\"sendMsg('message')\" @focus=\"inputFocus\" @blur=\"closePopWindow()\" confirm-type=\"send\"\r\n\t\t\t\t @keyboardHeightChange=\"onKeyboardHeightChange\" /> -->\r\n\t\t\t\t<view class=\"iconfont iconjiahao01 padding-right\" @click=\"openChatMore()\"></view>\r\n\t\t\t\t<view class=\"iconfont send_btn color-base-bg\" @click=\"sendMsg('message')\">发送</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"inputShow\" v-if=\"inputShow && inputFirst\"></view>\r\n\t\t\t<view v-if=\"emjoyShow\" @touchmove.prevent.stop>\r\n\t\t\t\t<view class=\"emjoy-box\">\r\n\t\t\t\t\t<scroll-view scroll-y=\"true\" class=\"emjoy-content\">\r\n\t\t\t\t\t\t<view class=\"emjoy-item\" v-for=\"(item, index) in emjoyList\" :key=\"index\" @click=\"addEmjoy(item, index)\">\r\n\t\t\t\t\t\t\t<image :src=\"$util.img(item)\"></image>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"more_send\" v-if=\"chatMore\">\r\n\t\t\t\t<view class=\"more_send-item\" @click=\"addImg()\">\r\n\t\t\t\t\t<i class=\"iconfont icontupian \"></i>\r\n\t\t\t\t\t<view>图片</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport SocketTask from '@/common/js/socketTest.js';\r\n\timport chatMessage from '@/otherpages/components/chat-message/chat-message.vue';\r\n\timport emjoy from '@/common/js/emjoy.js';\r\n\timport globalConfig from '@/common/js/golbalConfig.js';\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tchatMessage\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\temjoyList: emjoy.emjoyList,\r\n\t\t\t\temjoyShow: false,\r\n\t\t\t\tchatMore: false,\r\n\t\t\t\tformData: {\r\n\t\t\t\t\tcontent: '',\r\n\t\t\t\t\tgoods_id: 0,\r\n\t\t\t\t\torder_id: 0,\r\n\t\t\t\t\timage: ''\r\n\t\t\t\t},\r\n\t\t\t\tisNetWork: false,\r\n\t\t\t\tsend: false,\r\n\r\n\t\t\t\tmessageList: [],\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tisAll: false,\r\n\t\t\t\tisLoading: 0,\r\n\t\t\t\tshowLoading: false, //显示正在加载\r\n\r\n\t\t\t\tjumpBottom: null,\r\n\t\t\t\tscrollTop: 0,\r\n\t\t\t\tscrollPosition: 0,\r\n\r\n\t\t\t\tsiteId: 0, //店铺id\r\n\t\t\t\tskuId: 0, //商品id\r\n\t\t\t\torderId: 0, //订单id\r\n\t\t\t\tsiteName: '', //店铺名称\r\n\t\t\t\tshopInfo: {},\r\n\t\t\t\tuserInfo: {},\r\n\t\t\t\tstyle: {}, //聊天框的高度\r\n\t\t\t\tinputFirst: 0,\r\n\t\t\t\tinputShow: false,\r\n\t\t\t\tinputOffsetBottom: 0,\r\n\t\t\t\tgoods_type: {\r\n\t\t\t\t\tpromotion_name: '',\r\n\t\t\t\t\tpromotion_id: ''\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tmixins: [SocketTask, globalConfig],\r\n\t\tcomputed: {\r\n\t\t\tchatBottom() {\r\n\t\t\t\treturn this.emjoyShow || this.chatMore || this.inputShow;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(info) {\r\n\t\t\tif (info.site_id) {\r\n\t\t\t\tthis.siteId = info.site_id;\r\n\t\t\t\tthis.getShopInfo();\r\n\t\t\t} else {\r\n\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\ttitle: '缺少必要参数'\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.navigateBack();\r\n\t\t\t\t}, 1000);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.skuId = info.sku_id ? info.sku_id : 0;\r\n\t\t\tthis.orderId = info.order_id ? info.order_id : 0;\r\n\r\n\t\t\tif (this.skuId || this.orderId) {\r\n\t\t\t\tthis.send = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (info.type) {\r\n\t\t\t\tthis.goods_type.promotion_name = info.type;\r\n\t\t\t} else {\r\n\t\t\t\tthis.goods_type.promotion_name = '';\r\n\t\t\t}\r\n\t\t\tif (info.type_id) {\r\n\t\t\t\tthis.goods_type.promotion_id = info.type_id;\r\n\t\t\t} else {\r\n\t\t\t\tthis.goods_type.promotion_id = '';\r\n\t\t\t}\r\n\r\n\t\t\tif (uni.getStorageSync('token')) {\r\n\t\t\t\tthis.getUserInfo();\r\n\t\t\t} else {\r\n\t\t\t\tthis.$util.redirectTo('/pages/login/login/login');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.inputFirst = 0;\r\n\t\t\tthis.inputShow = false;\r\n\t\t\tthis.inputOffsetBottom = 0;\r\n\t\t},\r\n\t\tonReady() {\r\n\t\t\t// 监听键盘高度变化，以便设置输入框的高度\r\n\t\t\tuni.onKeyboardHeightChange(res => {\r\n\t\t\t\tthis.inputOffsetBottom = res.height;\r\n\t\t\t\tif (res.height === 0) {\r\n\t\t\t\t\tthis.focus = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 初次渲染输入框\r\n\t\t\tonEditorReady() {\r\n\t\t\t\tuni.createSelectorQuery()\r\n\t\t\t\t\t.select('#editor')\r\n\t\t\t\t\t.context(res => {})\r\n\t\t\t\t\t.exec();\r\n\t\t\t},\r\n\t\t\t// 输入时，边输入边保存\r\n\t\t\tonEditorinput() {\r\n\t\t\t\tuni.createSelectorQuery()\r\n\t\t\t\t\t.select('#editor')\r\n\t\t\t\t\t.context(res => {\r\n\t\t\t\t\t\tthis.editorCtx = res.context;\r\n\t\t\t\t\t\tthis.editorCtx.getContents({\r\n\t\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\t\tthis.formData.content = res.html;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.exec();\r\n\t\t\t},\r\n\t\t\t// 加号\r\n\t\t\topenChatMore() {\r\n\t\t\t\tif (this.$util.isAndroid) {\r\n\t\t\t\t\tthis.inputShow = false;\r\n\t\t\t\t\tthis.inputFirst = 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.chatMore = !this.chatMore;\r\n\t\t\t\tthis.emjoyShow = false;\r\n\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.setPageScrollTo();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//获取店铺详情，修改头部\r\n\t\t\tgetShopInfo() {\r\n\t\t\t\tif (this.siteId == 0) {\r\n\t\t\t\t\tthis.siteName = '平台客服';\r\n\t\t\t\t\t//修改标题\r\n\t\t\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\t\t\ttitle: this.siteName\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$api.sendRequest({\r\n\t\t\t\t\t\turl: '/api/shop/info',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tsite_id: this.siteId\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\t\t\t\tthis.shopInfo = res.data;\r\n\t\t\t\t\t\t\t\tthis.siteName = res.data.site_name;\r\n\t\t\t\t\t\t\t\t//修改标题\r\n\t\t\t\t\t\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\t\t\t\t\t\ttitle: this.siteName\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//获取个人信息\r\n\t\t\tgetUserInfo() {\r\n\t\t\t\tthis.$api.sendRequest({\r\n\t\t\t\t\turl: '/api/member/info',\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tif (res.code == 0) {\r\n\t\t\t\t\t\t\tthis.userInfo = res.data;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//获取聊天记录\r\n\t\t\tgetChatList() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tif (this.isAll) {\r\n\t\t\t\t\tif (that.mescroll) {\r\n\t\t\t\t\t\tthat.mescroll.endSuccess();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.isLoading) return;\r\n\t\t\t\tthis.isLoading = true;\r\n\t\t\t\tconsole.log(this.page, 'this.page')\r\n\t\t\t\tif (this.page == 1) this.messageList = [];\r\n\t\t\t\tthis.$api.sendRequest({\r\n\t\t\t\t\turl: '/servicer/api/chat/dialogs',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tservicer_id: this.servicer_id,\r\n\t\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t\tlimit: 7,\r\n\t\t\t\t\t\tsite_id: that.siteId\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tthat.page += 1;\r\n\t\t\t\t\t\tconsole.log(that.page, 'this.page')\r\n\t\t\t\t\t\tif (res.code >= 0 && res.data) {\r\n\t\t\t\t\t\t\tconsole.log(res.data.list.length, 'res.data.list')\r\n\t\t\t\t\t\t\tif (res.data.list && res.data.list.length < 5) that.isAll = true;\r\n\t\t\t\t\t\t\tlet startId = 0;\r\n\t\t\t\t\t\t\tif (this.messageList) {\r\n\t\t\t\t\t\t\t\tstartId = this.messageList.slice(-1).id + 1;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet newArr = [];\r\n\t\t\t\t\t\t\t//如果请求的是第一页，并且有订单id或商品id;添加发送信息\r\n\t\t\t\t\t\t\tif (that.skuId) {\r\n\t\t\t\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\t\t\t\tid: startId,\r\n\t\t\t\t\t\t\t\t\tisItMe: true,\r\n\t\t\t\t\t\t\t\t\tcontentType: 'sendGood',\r\n\t\t\t\t\t\t\t\t\tsku_id: that.skuId\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tnewArr.push(obj);\r\n\t\t\t\t\t\t\t\tstartId += 1;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t//如果获取到历史聊天信息  转换为需要的格式  添加到数组内\r\n\t\t\t\t\t\t\tlet arr = res.data.list;\r\n\t\t\t\t\t\t\tconsole.log(arr, 'arr')\r\n\t\t\t\t\t\t\tif (arr.length) {\r\n\t\t\t\t\t\t\t\tfor (let i = 0; i < arr.length; i++) {\r\n\t\t\t\t\t\t\t\t\tlet obj = {};\r\n\t\t\t\t\t\t\t\t\tif (arr[i].content_type == 0) {\r\n\t\t\t\t\t\t\t\t\t\tobj.id = startId;\r\n\t\t\t\t\t\t\t\t\t\tobj.content = arr[i].type == 0 ? arr[i].consumer_say : arr[i].servicer_say;\r\n\t\t\t\t\t\t\t\t\t\tobj.isItMe = arr[i].type == 0 ? true : false;\r\n\t\t\t\t\t\t\t\t\t\tobj.contentType = 'string';\r\n\t\t\t\t\t\t\t\t\t\tobj.sendStatus = true;\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(arr[i], 'arr[i]')\r\n\t\t\t\t\t\t\t\t\t\tif (arr[i].avatar) {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.avatar = arr[i].avatar\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.avatar = arr[i].logo\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else if (arr[i].content_type == 1) {\r\n\t\t\t\t\t\t\t\t\t\tobj.id = startId;\r\n\t\t\t\t\t\t\t\t\t\tobj.isItMe = arr[i].type == 0 ? true : false;\r\n\t\t\t\t\t\t\t\t\t\tif (arr[i].type != 1) {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.contentType = 'goods';\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.contentType = 'goodssku';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tobj.sku_id = arr[i].goods_sku_id;\r\n\t\t\t\t\t\t\t\t\t\tobj.send = false;\r\n\t\t\t\t\t\t\t\t\t\tobj.sendStatus = true;\r\n\t\t\t\t\t\t\t\t\t\tif (arr[i].avatar) {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.avatar = arr[i].avatar\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.avatar = arr[i].logo\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t} else if (arr[i].content_type == 2) {\r\n\t\t\t\t\t\t\t\t\t\tobj.id = startId;\r\n\t\t\t\t\t\t\t\t\t\tobj.isItMe = arr[i].type == 0 ? true : false;\r\n\t\t\t\t\t\t\t\t\t\tobj.contentType = 'order';\r\n\t\t\t\t\t\t\t\t\t\tobj.order_id = arr[i].order_id;\r\n\t\t\t\t\t\t\t\t\t\tobj.send = false;\r\n\t\t\t\t\t\t\t\t\t\tobj.sendStatus = true;\r\n\t\t\t\t\t\t\t\t\t\tif (arr[i].avatar) {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.avatar = arr[i].avatar\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.avatar = arr[i].logo\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} else if (arr[i].content_type == 3) {\r\n\t\t\t\t\t\t\t\t\t\tobj.id = startId;\r\n\t\t\t\t\t\t\t\t\t\tobj.isItMe = arr[i].type == 0 ? true : false;\r\n\t\t\t\t\t\t\t\t\t\tobj.contentType = 'image';\r\n\t\t\t\t\t\t\t\t\t\tobj.id = startId;\r\n\t\t\t\t\t\t\t\t\t\tobj.image = arr[i].type == 0 ? arr[i].consumer_say : arr[i].servicer_say;\r\n\t\t\t\t\t\t\t\t\t\tobj.sendStatus = true;\r\n\t\t\t\t\t\t\t\t\t\tif (arr[i].avatar) {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.avatar = arr[i].avatar\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tobj.avatar = arr[i].logo\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tnewArr.push(obj);\r\n\t\t\t\t\t\t\t\t\tstartId += 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (that.page == 2) {\r\n\t\t\t\t\t\t\t\tlet obj = {};\r\n\t\t\t\t\t\t\t\tobj.id = startId;\r\n\t\t\t\t\t\t\t\tif (that.servicer_id > 0) {\r\n\t\t\t\t\t\t\t\t\tobj.contentType = 'online';\r\n\t\t\t\t\t\t\t\t} else if (that.servicer_id == 0) {\r\n\t\t\t\t\t\t\t\t\tobj.contentType = 'noline';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tnewArr.push(obj);\r\n\t\t\t\t\t\t\t\tstartId += 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthat.isLoading = false;\r\n\t\t\t\t\t\t\tconsole.log(that.messageList, 'that.messageList')\r\n\t\t\t\t\t\t\tconsole.log(newArr, 'newArr')\r\n\t\t\t\t\t\t\tif (newArr.length) {\r\n\t\t\t\t\t\t\t\tthat.messageList = newArr.concat(that.messageList);\r\n\t\t\t\t\t\t\t\tthat.$nextTick(() => {\r\n\t\t\t\t\t\t\t\t\tif (that.page == 2) {\r\n\t\t\t\t\t\t\t\t\t\tthat.setPageScrollTo();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tlet id = '#chat' + newArr.length;\r\n\t\t\t\t\t\t\t\t\t\tthat.setPageScrollTo(id);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\t\t\t\ttitle: res.message\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 设置页面滚动位置\r\n\t\t\tsetPageScrollTo(id) {\r\n\t\t\t\tif (id) {\r\n\t\t\t\t\tlet view = uni\r\n\t\t\t\t\t\t.createSelectorQuery()\r\n\t\t\t\t\t\t.in(this)\r\n\t\t\t\t\t\t.select(id);\r\n\t\t\t\t\tview.boundingClientRect(res => {\r\n\t\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\t\tscrollTop: res.top - 30, // -30 为多显示出大半个消息的高度，示意上面还有信息。\r\n\t\t\t\t\t\t\tduration: 0\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}).exec();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet query = uni.createSelectorQuery().in(this);\r\n\t\t\t\t\tquery\r\n\t\t\t\t\t\t.select('.room-content-box')\r\n\t\t\t\t\t\t.boundingClientRect(data => {\r\n\t\t\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\t\t\tscrollTop: data.height - 30, // -30 为多显示出大半个消息的高度，示意上面还有信息。\r\n\t\t\t\t\t\t\t\tduration: 0\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.exec();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//发送商品\r\n\t\t\tsendGood(e, index) {\r\n\t\t\t\tthis.sendMsg('goods');\r\n\t\t\t\tthis.messageList.splice(index, 1);\r\n\t\t\t},\r\n\t\t\t//发送订单\r\n\t\t\tsendOrder(e, index) {\r\n\t\t\t\tthis.sendMsg('order');\r\n\t\t\t\tthis.messageList.splice(index, 1);\r\n\t\t\t},\r\n\t\t\t//发送消息\r\n\t\t\tsendMsg(data) {\r\n\t\t\t\tif (this.isNetWork) return;\r\n\t\t\t\tthis.isNetWork = true;\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tif (data == 'goods') {\r\n\t\t\t\t\tlet _type = {};\r\n\t\t\t\t\tif (this.goods_type.promotion_id != '') {\r\n\t\t\t\t\t\t_type.promotion_id = this.goods_type.promotion_id;\r\n\t\t\t\t\t\t_type.promotion_name = this.goods_type.promotion_name;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.$api.sendRequest({\r\n\t\t\t\t\t\turl: '/servicer/api/chat/say',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tgoods_id: this.skuId,\r\n\t\t\t\t\t\t\tservicer_id: this.servicer_id,\r\n\t\t\t\t\t\t\tcontent_type: 1,\r\n\t\t\t\t\t\t\tsite_id: this.siteId,\r\n\t\t\t\t\t\t\trelate_data: JSON.stringify(_type)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tthat.send = false;\r\n\t\t\t\t\t\t\tthat.joinData('send', 'goods');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\t\tthat.isNetWork = false;\r\n\t\t\t\t\t\t\t// uni.hideKeyboard();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (data == 'order') {\r\n\t\t\t\t\tthis.$api.sendRequest({\r\n\t\t\t\t\t\turl: '/servicer/api/chat/say',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\torder_id: this.orderId,\r\n\t\t\t\t\t\t\tservicer_id: this.servicer_id,\r\n\t\t\t\t\t\t\tsite_id: this.siteId,\r\n\t\t\t\t\t\t\tcontent_type: 2\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tthat.send = false;\r\n\t\t\t\t\t\t\tthat.joinData('send', 'order');\r\n\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\t\tthat.isNetWork = false;\r\n\t\t\t\t\t\t\t// uni.hideKeyboard();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (data == 'image') {\r\n\t\t\t\t\tthat.joinData('send', 'image');\r\n\t\t\t\t\tthis.$api.sendRequest({\r\n\t\t\t\t\t\turl: '/servicer/api/chat/say',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tmessage: this.formData.image.trim(),\r\n\t\t\t\t\t\t\tservicer_id: this.servicer_id,\r\n\t\t\t\t\t\t\tsite_id: this.siteId,\r\n\t\t\t\t\t\t\tcontent_type: 3\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tconsole.log(res, '图片上传成功');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror() {\r\n\t\t\t\t\t\t\tthat.messageList[that.messageList.length - 1].sendStatus = false;\r\n\t\t\t\t\t\t\tuni.createSelectorQuery()\r\n\t\t\t\t\t\t\t\t.select('#editor')\r\n\t\t\t\t\t\t\t\t.context(res => {\r\n\t\t\t\t\t\t\t\t\tthis.editorCtx = res.context;\r\n\t\t\t\t\t\t\t\t\tthis.editorCtx.clear();\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.exec();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\t\tthat.isNetWork = false;\r\n\t\t\t\t\t\t\t// uni.hideKeyboard();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// this.closePopWindow()\r\n\t\t\t\t\tconsole.log(this.formData.content, 'this.formData.content');\r\n\t\t\t\t\tlet _text = this.formData.content;\r\n\t\t\t\t\tlet _testText = _text.replace(/<p>/, '');\r\n\t\t\t\t\tlet _testText2 = _testText.replace(/<\\/p>/, '');\r\n\t\t\t\t\tlet _testText3 = _testText2.replace(/<br>/, '');\r\n\t\t\t\t\tif (_text == '<p></p>' || _text == '<p><br></p>' || !_testText3.trim()) {\r\n\t\t\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\t\t\ttitle: '发送内容不能为空'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tuni.createSelectorQuery()\r\n\t\t\t\t\t\t\t.select('#editor')\r\n\t\t\t\t\t\t\t.context(res => {\r\n\t\t\t\t\t\t\t\tthat.editorCtx = res.context;\r\n\t\t\t\t\t\t\t\tthat.editorCtx.clear();\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.exec();\r\n\t\t\t\t\t\tthat.isNetWork = false;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.joinData('send', 'string');\r\n\t\t\t\t\tthis.$api.sendRequest({\r\n\t\t\t\t\t\turl: '/servicer/api/chat/say',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tmessage: this.formData.content,\r\n\t\t\t\t\t\t\tservicer_id: this.servicer_id,\r\n\t\t\t\t\t\t\tsite_id: this.siteId,\r\n\t\t\t\t\t\t\tcontent_type: 0\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t// that.joinData('send', 'string');\r\n\t\t\t\t\t\t\tconsole.log(res, '文字上传成功');\r\n\t\t\t\t\t\t\tthat.formData.content = '<p></p>';\r\n\t\t\t\t\t\t\tuni.createSelectorQuery()\r\n\t\t\t\t\t\t\t\t.select('#editor')\r\n\t\t\t\t\t\t\t\t.context(res => {\r\n\t\t\t\t\t\t\t\t\tthis.editorCtx = res.context;\r\n\t\t\t\t\t\t\t\t\tthis.editorCtx.clear();\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.exec();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror() {\r\n\t\t\t\t\t\t\tthat.messageList[that.messageList.length - 1].sendStatus = false;\r\n\t\t\t\t\t\t\tuni.createSelectorQuery()\r\n\t\t\t\t\t\t\t\t.select('#editor')\r\n\t\t\t\t\t\t\t\t.context(res => {\r\n\t\t\t\t\t\t\t\t\tthis.editorCtx = res.context;\r\n\t\t\t\t\t\t\t\t\tthis.editorCtx.clear();\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.exec();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\t\tthat.isNetWork = false;\r\n\t\t\t\t\t\t\t// uni.hideKeyboard();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//拼接消息 处理滚动\r\n\t\t\tasync joinData(addType, contentType) {\r\n\t\t\t\tif (addType == 'send') {\r\n\t\t\t\t\tlet data = {\r\n\t\t\t\t\t\tisItMe: true,\r\n\t\t\t\t\t\tcontentType: contentType,\r\n\t\t\t\t\t\tsendStatus: true\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (contentType == 'string') {\r\n\t\t\t\t\t\tdata.content = this.formData.content;\r\n\t\t\t\t\t} else if (contentType == 'order') {\r\n\t\t\t\t\t\tdata.order_id = this.orderId;\r\n\t\t\t\t\t} else if (contentType == 'goods') {\r\n\t\t\t\t\t\tdata.sku_id = this.skuId;\r\n\t\t\t\t\t} else if (contentType == 'image') {\r\n\t\t\t\t\t\tdata.image = this.formData.image;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.messageList.push(data);\r\n\t\t\t\t\t// this.formData.content = '';\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tthis.setPageScrollTo();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 隐藏加载提示\r\n\t\t\thideLoadTips(flag) {\r\n\t\t\t\tif (flag) {\r\n\t\t\t\t\tthis.ajax.loadText = '消息获取成功';\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.ajax.loading = false;\r\n\t\t\t\t\t}, 300);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.ajax.loading = true;\r\n\t\t\t\t\tthis.ajax.loadText = '正在获取消息';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonPageScroll(e) {\r\n\t\t\t\tif (e.scrollTop < 5 && e.scrollTop >= 0) {\r\n\t\t\t\t\tthis.getChatList();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//\r\n\t\t\tinputFocus(e) {\r\n\t\t\t\tif (this.$util.isAndroid() && this.inputFirst) {\r\n\t\t\t\t\tthis.inputShow = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.chatMore = false;\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.setPageScrollTo();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tclosePopWindow() {\r\n\t\t\t\tthis.inputFirst = 0;\r\n\t\t\t\tthis.chatMore = false;\r\n\t\t\t\tthis.inputShow = false;\r\n\t\t\t\t// uni.hideKeyboard();\r\n\t\t\t},\r\n\t\t\t// 展开表情\r\n\t\t\topenEmjoy() {\r\n\t\t\t\tconsole.log(this.emjoyShow, 'this.emjoyShow');\r\n\t\t\t\t// if (this.$util.isAndroid()) {\r\n\t\t\t\t// \tthis.inputFirst = 1;\r\n\t\t\t\t// \tthis.inputShow = !this.inputShow;\r\n\t\t\t\t// }\r\n\r\n\t\t\t\t// uni.hideKeyboard();\r\n\t\t\t\tthis.chatMore = false;\r\n\t\t\t\tthis.emjoyShow = !this.emjoyShow;\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.setPageScrollTo();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 添加表情\r\n\t\t\taddEmjoy(emjoy, index) {\r\n\t\t\t\tuni.createSelectorQuery()\r\n\t\t\t\t\t.select('#editor')\r\n\t\t\t\t\t.context(res => {\r\n\t\t\t\t\t\tthis.editorCtx = res.context;\r\n\t\t\t\t\t\tthis.editorCtx.getContents({\r\n\t\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\t\tif (res.html == '<p><br></p>') {\r\n\t\t\t\t\t\t\t\t\tres.html = '<p></p>';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tlet _src = this.$util.img(emjoy);\r\n\t\t\t\t\t\t\t\tlet text = '<img src=' + _src + ' style=\"height=\"20px; width=20px; margin-left=20px;\">';\r\n\t\t\t\t\t\t\t\tlet html2 = res.html.replace(/<\\/p>$/, text + '</p>');\r\n\t\t\t\t\t\t\t\tthis.editorCtx.setContents({\r\n\t\t\t\t\t\t\t\t\thtml: html2\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tthis.formData.content = html2;\r\n\t\t\t\t\t\t\t\tthis.emjoyShow = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.exec();\r\n\t\t\t\t// this.formData.content = this.formData.content + index;\r\n\t\t\t},\r\n\t\t\t// 发送图片\r\n\t\t\taddImg() {\r\n\t\t\t\tthis.$util.upload(\r\n\t\t\t\t\t1, {\r\n\t\t\t\t\t\tpath: 'chatimg'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tres => {\r\n\t\t\t\t\t\tthis.formData.image = res[0];\r\n\t\t\t\t\t\t// this.chatMore = false;\r\n\t\t\t\t\t\tthis.sendMsg('image');\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'/servicer/api/chat/chatimg'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t\tbeforeDestroy() {\r\n\t\t\tclearInterval(this.timeoutObj);\r\n\t\t\tthis.timeoutObj = null;\r\n\t\t\tthis.$api.sendRequest({\r\n\t\t\t\turl: '/servicer/api/chat/bye',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tservicer_id: this.servicer_id,\r\n\t\t\t\t\tsite_id: this.siteId\r\n\t\t\t\t},\r\n\t\t\t\tsuccess(res) {\r\n\t\t\t\t\tuni.closeSocket();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t//处理H5端弹出覆盖输入框的问题\r\n\t.more_send {\r\n\t\tdisplay: flex;\r\n\t\tborder-top: 2rpx solid #e5e5e5;\r\n\t\theight: 390rpx;\r\n\t\tflex-wrap: wrap;\r\n\r\n\t\t>view {\r\n\t\t\tpadding-top: 16rpx;\r\n\t\t\twidth: 25%;\r\n\t\t\theight: 156rpx;\r\n\t\t\ttext-align: center;\r\n\r\n\t\t\t.iconfont {\r\n\t\t\t\tdisplay: inline;\r\n\t\t\t\tfont-size: 60rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t\tbackground-color: #fff;\r\n\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t\tpadding: 20rpx;\r\n\t\t\t}\r\n\r\n\t\t\t>view {\r\n\t\t\t\tcolor: #909399;\r\n\t\t\t\tfont-size: $font-size-goods-tag;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.chat_send {\r\n\t\tdisplay: flex;\r\n\t\theight: 45px;\r\n\t\tjustify-content: space-between;\r\n\t\tposition: relative;\r\n\r\n\t\t.send {\r\n\t\t\tposition: absolute;\r\n\t\t\tright: 30rpx;\r\n\t\t\tbottom: 30rpx;\r\n\t\t\tcolor: #fff;\r\n\t\t\talign-self: flex-end;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tpadding: 10rpx 20rpx;\r\n\t\t\tborder-radius: 8rpx;\r\n\t\t}\r\n\r\n\t\t.emjoy_list {\r\n\t\t\tflex: 1;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 加载数据提示 */\r\n\t.tips {\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\ttop: var(--window-top);\r\n\t\twidth: 100%;\r\n\t\tz-index: 9;\r\n\t\tbackground-color: rgba(0, 0, 0, 0);\r\n\t\theight: 72rpx;\r\n\t\tline-height: 72rpx;\r\n\t\ttransform: translateY(-80rpx);\r\n\t\ttransition: transform 0.3s ease-in-out 0s;\r\n\t\tfont-size: 24rpx;\r\n\t\ttext-align: center;\r\n\t\tline-height: 72rpx;\r\n\r\n\t\t&.show {\r\n\t\t\ttransform: translateY(0);\r\n\t\t}\r\n\t}\r\n\r\n\t.room {\r\n\t\twidth: 100%;\r\n\t\t/* #ifdef H5 */\r\n\t\tmin-height: calc(100vh - 24px);\r\n\t\tpadding-bottom: calc(110rpx + 44px);\r\n\t\tpadding-bottom: calc(110rpx + 44px + constant(safe-area-inset-bottom));\r\n\t\tpadding-bottom: calc(110rpx + 44px + env(safe-area-inset-bottom));\r\n\t\t/* #endif */\r\n\r\n\t\t/* #ifndef H5 */\r\n\t\tmin-height: calc(100vh + 10px);\r\n\t\tpadding-bottom: 110rpx;\r\n\t\tpadding-bottom: calc(110rpx + constant(safe-area-inset-bottom));\r\n\t\tpadding-bottom: calc(110rpx + env(safe-area-inset-bottom));\r\n\t\t/* #endif */\r\n\r\n\t\tbox-sizing: border-box;\r\n\r\n\t\t.room-content-box {\r\n\t\t\twidth: 100%;\r\n\t\t\tmin-height: calc(100% + 10px);\r\n\t\t\tpadding-top: $padding;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t}\r\n\t}\r\n\r\n\t.paddingbottom {\r\n\t\theight: calc(470rpx + 44px);\r\n\t}\r\n\r\n\t.emjoy-box {\r\n\t\twidth: 100%;\r\n\t\theight: 300rpx;\r\n\t\tpadding: 20rpx 25rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\tbackground: #f4f4f4;\r\n\t\tborder-top: 1rpx solid #e5e5e5;\r\n\r\n\t\t.emjoy-content {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100%;\r\n\r\n\t\t\t.emjoy-item {\r\n\t\t\t\tdisplay: inline-block;\r\n\t\t\t\twidth: 100rpx;\r\n\t\t\t\theight: 70rpx;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tline-height: 70rpx;\r\n\r\n\t\t\t\timage {\r\n\t\t\t\t\tdisplay: inline-block;\r\n\t\t\t\t\twidth: 40rpx;\r\n\t\t\t\t\theight: 40rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.input-content {\r\n\t\tbackground: #f4f4f4;\r\n\t\twidth: 100%;\r\n\t\tmin-height: 110rpx;\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\tbottom: 0;\r\n\t\tpadding-bottom: 0px;\r\n\t\tpadding-bottom: constant(safe-area-inset-bottom);\r\n\t\tpadding-bottom: env(safe-area-inset-bottom);\r\n\r\n\t\t.input-box {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: auto;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: flex-end;\r\n\t\t\tpadding: 10rpx $padding;\r\n\t\t\tbox-sizing: border-box;\r\n\r\n\t\t\t.iconfont {\r\n\t\t\t\tline-height: 1;\r\n\t\t\t\tfont-size: 52rpx;\r\n\t\t\t\tpadding: 15rpx;\r\n\r\n\t\t\t\t&.send_btn {\r\n\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\tmin-width: 60rpx;\r\n\t\t\t\t\ttext-align: center;\r\n\t\t\t\t\tbackground-color: #e8e8e8;\r\n\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\t\theight: 32rpx;\r\n\t\t\t\t\tline-height: 32rpx;\r\n\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.message-edit {\r\n\t\t\t\tpadding: 4rpx 15rpx;\r\n\t\t\t\tline-height: 1.5;\r\n\t\t\t\tbackground-color: #ffffff;\r\n\t\t\t\t// height: 90rpx;\r\n\t\t\t\tmin-height: 60rpx !important;\r\n\t\t\t\t// max-height: 200rpx;\r\n\t\t\t\theight: auto !important;\r\n\t\t\t\tborder-radius: 30rpx;\r\n\t\t\t\tfont-size: $font-size-base;\r\n\t\t\t}\r\n\r\n\t\t\t// input {\r\n\t\t\t// \tmargin-left: 20rpx;\r\n\t\t\t// \tmargin-right: 20rpx;\r\n\t\t\t// \twidth: 630rpx;\r\n\t\t\t// \theight: 100%;\r\n\t\t\t// \theight: 72rpx;\r\n\t\t\t// \tpadding: 0 20rpx;\r\n\t\t\t// \tfont-size: $font-size-tag;\r\n\t\t\t// \tbackground-color: #fff;\r\n\t\t\t// \tborder-radius: 8rpx;\r\n\t\t\t// }\r\n\t\t}\r\n\t}\r\n</style>\r\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1651682665297\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}